---
layout: post
title: "Physical Attacks via FireWire"
---
"This is pretty scary":http://www.darkreading.com/document.asp?doc_id=147713&f_src=drweekly â€” a proof-of-concept attack that disables authentication in Windows within seconds, just by plugging in a special FireWire peripheral. It's well-known that with physical access to a computer you can compromise it; but generally that involves activities that are time-consuming or blatantly obvious, like rebooting from a CD or swapping out hard drives. This new attack, though, takes only a few seconds; and the peripheral might look as innocuous as an iPod.

Worse, what enables this is not a bug in a driver, but a _feature_ of the FireWire interface; so (as I understand it) there's no real way to disable it, short of disabling the FireWire port entirely. "These slides (in PDF)":http://www.security-assessment.com/files/presentations/ab_firewire_rux2k6-final.pdf by the author of the exploit describe it in more detail. It turns out that the FireWire protocol directly allows any device on the bus to read and write the physical RAM of any other device on the bus. (Any old-school BASIC programmers out there remember PEEK and POKE? Same idea.) That's _physical_ RAM, below the VM layer, so there are no access privileges; it's all available. The drawback is that mapping from that to the virtual address space that the OS uses is pretty complicated, and then the attack has to locate the desired kernel data structures (in this case the ones that enable password authentication) ... but it's clearly do-able, and has been demonstrated on Windows XP.

Now I'm looking at that FireWire port on my MacBook Pro with some concern. It's basically _a hole into the innards of the kernel_, bypassing any security mechanisms. I feel like my computer's been "trepanated":http://en.wikipedia.org/wiki/Trepanation.
!http://upload.wikimedia.org/wikipedia/commons/thumb/b/b7/Peter_Treveris_-_engraving_of_Trepanation_for_Handywarke_of_surgeri_1525.png/250px-Peter_Treveris_-_engraving_of_Trepanation_for_Handywarke_of_surgeri_1525.png!

(*Update:* The comments on "Bruce Schneier's blog post about this":http://www.schneier.com/blog/archives/2008/03/physically_hack.html are interesting, particularly this one by Chris Adams:

bq. I find it interesting to see the time delay between the Mac and Windows security worlds - the first Firewire DMA-based hack I remember was the 2002 FireStarter attack. Apple modified their drivers to disable device DMA by the time 10.3 came out.
This was very widely discussed in various Mac news forums, blogs, etc. and a few security conferences. At some point the Linux crowd started making the same fixes and yet, somehow, it took half a decade before this finally got the Windows security community?